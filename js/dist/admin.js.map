{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@justoverclock/hot-discussions/webpack/bootstrap","webpack://@justoverclock/hot-discussions/webpack/runtime/compat get default export","webpack://@justoverclock/hot-discussions/webpack/runtime/define property getters","webpack://@justoverclock/hot-discussions/webpack/runtime/hasOwnProperty shorthand","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['admin/app']\"","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['extensions/afrux-forum-widgets-core/common/extend/Widgets']\"","webpack://@justoverclock/hot-discussions/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['extensions/afrux-forum-widgets-core/common/components/Widget']\"","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['forum/app']\"","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['common/components/Link']\"","webpack://@justoverclock/hot-discussions/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@justoverclock/hot-discussions/./src/common/components/hotDiscussionsWidget.js","webpack://@justoverclock/hot-discussions/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@justoverclock/hot-discussions/./src/admin/index.js","webpack://@justoverclock/hot-discussions/./src/common/registerWidget.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extensions/afrux-forum-widgets-core/common/extend/Widgets'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extensions/afrux-forum-widgets-core/common/components/Widget'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import Widget from 'flarum/extensions/afrux-forum-widgets-core/common/components/Widget';\nimport app from 'flarum/forum/app';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Link from 'flarum/common/components/Link';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default class HotDiscussionsWidget extends Widget {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = true;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n    \n    const limitHotDisc = app.forum.attribute('justoverclock-hot-discussions.discLimit') || 10;\n    const hideClosed = app.forum.attribute('justoverclock-hot-discussions.hideClosed') === '1';\n    const filterParams = hideClosed ? { q: '-is:locked' } : {};\n\n    // 核心逻辑保留：多获取数据以防过滤损耗\n    const fetchLimit = limitHotDisc * 3;\n\n    app.store\n      .find('discussions', {\n        sort: '-commentCount',\n        filter: filterParams,\n        page: { limit: fetchLimit },\n        // include 'state' 修复阅读进度跳转\n        // include 'tags' 用于过滤隐藏标签\n        include: 'tags,state', \n      })\n      .then((results) => {\n        // 过滤隐藏标签\n        const visibleDiscussions = results.filter((disc) => {\n          const tags = disc.tags();\n          if (!tags) return true;\n          return !tags.some((tag) => tag.subscription() === 'hide');\n        });\n\n        this.hotDisc = visibleDiscussions.slice(0, limitHotDisc);\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  className() {\n    return 'hotDiscussions-widget';\n  }\n\n  icon() {\n    // 保持原有图标，但去掉了强制红色的类\n    return 'fab fa-hotjar'; \n  }\n\n  title() {\n    return app.translator.trans('justoverclock-hot-discussions.forum.widget-title');\n  }\n\n  content() {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n    \n    return (\n      <div className=\"hotDiscussion-content\">\n        <ul className=\"hotDisc-list\">\n          {this.hotDisc.map((disc) => {\n            return (\n              <li className=\"hotDisc-item\">\n                <Link href={app.route.discussion(disc)} className=\"hotDisc-link\">\n                  \n                  {/* 左侧：简单的序号或图标装饰，这里用一个小圆点装饰 */}\n                  <span className=\"hotDisc-bullet\"></span>\n\n                  {/* 中间：标题 */}\n                  <span className=\"hotDisc-title\">{disc.title()}</span>\n\n                  {/* 右侧：极简的评论数统计 */}\n                  <span className=\"hotDisc-stats\">\n                    {icon('fas fa-comment-alt')} {disc.commentCount()}\n                  </span>\n                  \n                </Link>\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","/*\n * This file is part of Hot Discussions Widget.\n *\n * Copyright (c) 2021 Marco Colia.\n * https://flarum.it\n *\n * For the full copyright and license information, please view the LICENSE.md\n * file that was distributed with this source code.\n */\n\nimport app from 'flarum/admin/app';\nimport registerWidget from '../common/registerWidget';\n\napp.initializers.add('justoverclock/hot-discussions', () => {\n    registerWidget(app);\n    app.extensionData\n      .for('justoverclock-hot-discussions')\n      .registerSetting({\n        setting: 'justoverclock-hot-discussions.discLimit',\n        name: 'justoverclock-hot-discussions.discLimit',\n        type: 'number',\n        label: app.translator.trans('justoverclock-hot-discussions.admin.discLimit'),\n        help: app.translator.trans('justoverclock-hot-discussions.admin.discLimit-help'),\n      })\n      .registerSetting({\n        setting: 'justoverclock-hot-discussions.hideClosed',\n        type: 'boolean',\n        label: app.translator.trans('justoverclock-hot-discussions.admin.hideClosed'),\n      })\n});\n","/*\n * This file is part of Hot Discussions Widget.\n *\n * Copyright (c) 2021 Marco Colia.\n * https://flarum.it\n *\n * For the full copyright and license information, please view the LICENSE.md\n * file that was distributed with this source code.\n */\n\nimport Widgets from 'flarum/extensions/afrux-forum-widgets-core/common/extend/Widgets';\nimport hotDiscussionsWidget from './components/hotDiscussionsWidget';\n\nexport default function (app) {\n    new Widgets()\n        .add({\n            key: 'discHot',\n            component: hotDiscussionsWidget,\n            isDisabled: false,\n            isUnique: true,\n            placement: 'end',\n            position: 1,\n        })\n        .extend(app, 'justoverclock-hot-discussions');\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","HotDiscussionsWidget","_Widget","apply","arguments","create","constructor","_proto","oninit","vnode","this","loading","oncreate","_this","limitHotDisc","app","attribute","filterParams","q","fetchLimit","find","sort","filter","page","limit","include","then","results","visibleDiscussions","disc","tags","some","tag","subscription","hotDisc","slice","m","redraw","className","icon","title","trans","content","LoadingIndicator","map","Link","href","discussion","commentCount","Widget","add","Widgets","component","hotDiscussionsWidget","isDisabled","isUnique","placement","position","extend","registerSetting","setting","name","type","label","help"],"ignoreList":[],"sourceRoot":""}